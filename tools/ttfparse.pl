#!/opt/local/bin/perl
# TTF Font Parser
# RamzAfzar Vulnerability Analysis Team
 
use IO::File;
use warnings;
 
my $n = 0;
my $buf  = "";    
my $path = "";
my $fh   = IO::File->new();
my $num_args = @ARGV;
 
if ($num_args != 1)
{
print " \r\n\r\n Usage: \r\n parse.pl fontname.ttf \r\n\r\n";
exit;
}
 
$path = $ARGV[0];
print $path;
open $fh, $path or die $!;
binmode $fh;
 
$n = read $fh, $buf, 12;
if ($n < 1)
{
    print "Error in reading file!";
    exit;
}
 
my ( $version, $number ) = unpack( "Nn", $buf );
print " Font Version = $version, No. of tables = $number\n";
print "\nTABLE\tOFFSET\tLENGTH\n";
 
for ( my $i = 0 ; $i < $number ; $i++ ) {
    read( $fh, $buf, 16 );
    my ( $table, $offset, $length ) = unpack( "a4x4NN", $buf );
    $table->{$table} = $offset;
    print "$table\t$offset\t$length\n";
}