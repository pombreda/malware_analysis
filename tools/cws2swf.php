<?PHP
/*
 * Decompress CWS Flash to SWF using gzinflate in PHP.
 * Outputs a .unc file
 * @tylabs TyLabs.com
*/


if (!isset($argv[1])) {
	echo "Specify a file or directory.\n";
	exit(0);
}


//accept a file as input
if (is_file($argv[1])) {
	$result = flashExplode(file_get_contents($argv[1]));
	file_put_contents($argv[1].".unc", $result);
}

function flashExplode ($stream) {

	$magic = substr($stream, 0, 3);

	if ($magic == "CWS") {
		$header = substr($stream, 4, 5);
		$content = substr($stream, 10);
		$uncompressed = gzinflate($content);
		return "FWS".$header.$uncompressed;
	} else
		return $stream;

}


?>